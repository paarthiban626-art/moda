<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flappy Bird with Name</title>
  <style>
    html, body {
      height: 100%; margin: 0;
      display: flex; align-items: center; justify-content: center;
      background: #70c5ce;
    }
    #gameWrapper {
      position: relative; width: 100%; max-width: 420px;
    }
    canvas {
      display: block; border: 6px solid #2b6b6b;
      border-radius: 8px; width: 100%; height: auto;
      touch-action: none; /* prevent scrolling while playing */
    }
    #message {
      position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.7); color: white;
      padding: 14px; border-radius: 10px;
      text-align: center; width: 80%;
    }
    #playerName {
      margin-top: 8px; padding: 6px; font-size: 14px;
      width: 90%; max-width: 250px; border-radius: 6px; border: none;
      text-align: center;
    }
    #startBtn {
      margin-top: 10px; padding: 6px 12px; font-size: 14px;
      border-radius: 6px; border: none; background: #2b6b6b; color: white;
      cursor: pointer;
    }
    #warning {
      margin-top: 6px;
      font-size: 12px;
      color: #ffcc00;
    }
    #scoreBoard {
      position: absolute; top: 8px; left: 8px;
      font-family: Arial, sans-serif; font-size: 20px;
      font-weight: bold; color: #fff;
      text-shadow: 2px 2px 2px black;
    }
  </style>
</head>
<body>
  <div id="gameWrapper">
    <canvas id="gameCanvas" width="320" height="480"></canvas>
    <div id="scoreBoard">Score:0</div>
    <div id="message">
      <div>Enter your name:</div>
      <input id="playerName" type="text" placeholder="Your name">
      <button id="startBtn">Start / Restart</button>
      <div id="warning"></div>
    </div>
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const W = canvas.width, H = canvas.height;
    let running = false, frame = 0, score = 0, pipes = [];
    let playerName = "";
    const scoreEl = document.getElementById("scoreBoard");
    const msgBox = document.getElementById("message");
    const playerInput = document.getElementById("playerName");
    const startBtn = document.getElementById("startBtn");
    const warningDiv = document.getElementById("warning");

    // bird setup
    let bird = {x:80, y:H/2, w:24, h:24, vy:0};

    // detect mobile
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

    // spawn pipe
    function spawnPipe(x) {
      let gap = 100;
      let top = Math.random() * (H - gap - 80) + 40;
      return {x:x, top:top, w:50, gap:gap};
    }

    function reset() {
      running = false;
      msgBox.style.display = "block";
      warningDiv.textContent = "";
      bird.y = H/2; bird.vy = 0;
      pipes = [];
    }

    function startGame() {
      if(playerInput.value.trim() === ""){
        warningDiv.textContent = "⚠️ Please enter your name first.";
        playerInput.scrollIntoView({behavior:"smooth", block:"center"});

        // desktop only: focus
        if(!isMobile) playerInput.focus();
        return;
      }
      playerName = playerInput.value.trim();
      pipes=[]; frame=0; score=0; scoreEl.textContent="Score:0";
      bird.x=80; bird.y=H/2; bird.vy=0;
      running=true; msgBox.style.display="none";
      for(let i=0;i<3;i++) pipes.push(spawnPipe(W+i*160));
      requestAnimationFrame(loop);
    }

    function loop() {
      if(!running) return;
      ctx.fillStyle="#70c5ce";
      ctx.fillRect(0,0,W,H);

      bird.vy+=0.5; bird.y+=bird.vy;
      ctx.fillStyle="yellow";
      ctx.fillRect(bird.x, bird.y, bird.w, bird.h);

      if(bird.y+bird.h>H || bird.y<0){ reset(); return; }

      frame++;
      if(frame%90===0) pipes.push(spawnPipe(W));
      for(let i=0;i<pipes.length;i++){
        let p = pipes[i];
        p.x-=2;
        ctx.fillStyle="green";
        ctx.fillRect(p.x,0,p.w,p.top);
        ctx.fillRect(p.x,p.top+p.gap,p.w,H-(p.top+p.gap));
        if(bird.x+bird.w>p.x && bird.x<p.x+p.w &&
           (bird.y<p.top || bird.y+bird.h>p.top+p.gap)){
          reset(); return;
        }
        if(p.x+p.w===bird.x){ score++; scoreEl.textContent="Score:"+score; }
      }
      pipes=pipes.filter(p=>p.x>-50);

      requestAnimationFrame(loop);
    }

    canvas.addEventListener("click", ()=>{ if(running) bird.vy=-8; });
    document.addEventListener("keydown", e=>{ if(e.code==="Space" && running) bird.vy=-8; });
    startBtn.addEventListener("click", startGame);

    reset();
  </script>
</body>
</html>
    
